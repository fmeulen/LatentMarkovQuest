ggplot(acf_data, aes(x = Lag, y = ACF)) +
geom_bar(stat = "identity", fill = "blue", alpha = 0.7) +
geom_hline(yintercept = c(0.2, -0.2), linetype = "dashed", color = "red") +
labs(title = "Faceted Autocorrelation Plot", x = "Lag", y = "ACF") +
facet_wrap(as.formula(paste('~', factor_col))) +
theme_minimal()
}
# Example usage with a sample dataset
# Creating a sample dataset
set.seed(123)
example_data <- tibble(
time_series = c(rnorm(50, mean = 10), rnorm(50, mean = 20)),
group = rep(c("A", "B"), each = 50)
)
# Using the function with the sample dataset
faceted_autocorrelation_plot(example_data, "time_series", "group")
# Load necessary libraries
library(ggplot2)
library(tibble)
library(dplyr)
library(tidyr)
# Define the function to create faceted autocorrelation plots
faceted_autocorrelation_plot <- function(data, time_series_col, factor_col, max_lag = 20) {
# Compute the autocorrelation for each factor level
acf_data <- data %>%
group_by(.data[[factor_col]]) %>%
do(acf = acf(.$[[time_series_col]], plot = FALSE, lag.max = max_lag)) %>%
# Load necessary libraries
library(ggplot2)
library(tibble)
library(dplyr)
library(tidyr)
# Define the function to create faceted autocorrelation plots
faceted_autocorrelation_plot <- function(data, time_series_col, factor_col, max_lag = 20) {
# Compute the autocorrelation for each factor level
acf_data <- data %>%
group_by(.data[[factor_col]]) %>%
do(acf = acf(.$[[time_series_col]], plot = FALSE, lag.max = max_lag)) %>%
iterates %>% group_by)(chain) %>% summarise(acf=acf(`γup[1]`))
iterates %>% group_by(chain) %>% summarise(acf=acf(`γup[1]`))
iterates %>% group_by(chain) %>% summarise(acf=acf(`γup[1]`)$acf)
iterates %>% group_by(chain) %>% summarise(acf=acf(`γup[1]`,plot=F)$acf)
?reframe
iterates %>% group_by(chain) %>% reframe(acf=acf(`γup[1]`,plot=F)$acf)
iterates %>% group_by(chain) %>% reframe(acf=acf(`γup[1]`,plot=F)$acf, lag=acf(`γup[1]`,plot=F)$lag)
iterates %>% group_by(chain) %>% reframe(acf=acf(`γup[1]`,plot=F)$acf, lag=acf(`γup[1]`,plot=F)$lag) %>%
ggplot(aes(x=lag, y=acf)) + geom_point()
iterates %>% group_by(chain) %>% reframe(acf=acf(`γup[1]`,plot=F)$acf, lag=acf(`γup[1]`,plot=F)$lag) %>%
ggplot(aes(x=lag, y=acf)) + geom_point() + facet_wrap(~chain)
iterates %>% group_by(chain) %>% reframe(acf=acf(`γup[1]`,plot=F)$acf, lag=acf(`γup[1]`,plot=F)$lag) %>%
ggplot(aes(x=lag, y=acf)) + geom_point() + facet_wrap(~chain)
?geom_segment
df_acf <- iterates %>% group_by(chain) %>% reframe(acf=acf(`γup[1]`,plot=F)$acf, lag=acf(`γup[1]`,plot=F)$lag)
df_acf
df_acf %>% ggplot(aes(x=lag, y=acf)) +
geom_bar(stat = "identity", position = "identity")
df_acf %>% ggplot(aes(x=lag, y=acf)) +
geom_bar(stat = "identity", position = "identity") + facet_wrap(~chain)
df_acf <- iterates %>% group_by(chain) %>% reframe(acf=acf(`γup[1]`,plot=F)$acf, lag=acf(`γup[1]`,plot=F)$lag)
df_acf %>% ggplot(aes(x=lag, y=acf)) +
geom_bar(stat = "identity", position = "identity") + facet_wrap(~chain)
df_acf
theme_set(theme_light())
df_acf <- iterates %>% group_by(chain) %>% reframe(acf=acf(`γup[1]`,plot=F)$acf, lag=acf(`γup[1]`,plot=F)$lag)
df_acf %>% ggplot(aes(x=lag, y=acf)) +
geom_bar(stat = "identity", position = "identity") + facet_wrap(~chain)
theme_set(theme_bw())
df_acf <- iterates %>% group_by(chain) %>% reframe(acf=acf(`γup[1]`,plot=F)$acf, lag=acf(`γup[1]`,plot=F)$lag)
df_acf %>% ggplot(aes(x=lag, y=acf)) +
geom_bar(stat = "identity", position = "identity") + facet_wrap(~chain)
iterates %>% ggplot(aes(x=iteration, y=`Z1[2]`, colour=chain)) + geom_line()
iterates %>% ggplot(aes(x=iteration, y=`γup[1]`, colour=chain)) + geom_line()
?ggarrange
library(ggpubr)
p1 <- iterates %>% ggplot(aes(x=iteration, y=`σα²`, colour=chain)) + geom_line()
p2 <- iterates %>% ggplot(aes(x=iteration, y=`σ²`, colour=chain)) + geom_line()
p3 <- iterates %>% ggplot(aes(x=iteration, y=`αup[15]`, colour=chain)) + geom_line()
p4 <- iterates %>% ggplot(aes(x=iteration, y=`γup[1]`, colour=chain)) + geom_line()
p5 <- iterates %>% ggplot(aes(x=iteration, y=`Z1[2]`, colour=chain)) + geom_line()
p6 <- iterates %>% ggplot(aes(x=iteration, y=`αdown[23]`, colour=chain)) + geom_line()
ggarrange(p1, p2, p3, p4, p5, p6)
iterates
names(iterates)
#View(iterates)
iterates <- iterates_full %>% select(1:70)
iterates_full <- read_csv("figs/iterates.csv", col_types = cols(chain = col_character()))
#View(iterates)
iterates <- iterates_full %>% select(1:70)
?pivot_longer
pivot_longer(iterates, 3:70, names_to="parameter", values_to="value")
iterates_long <- pivot_longer(iterates, 3:70, names_to="parameter", values_to="value")
iterates_long %>% filter(parameter %in% c(`σα²`, `σ²`,`αup[15]`,`γup[1]`,`Z1[2]`,`αdown[23]` ))
iterates_long %>% dplyr::filter(parameter %in% c(`σα²`, `σ²`,`αup[15]`,`γup[1]`,`Z1[2]`,`αdown[23]` ))
iterates_long %>% dplyr::filter(parameter %in% c(σα², `σ²`,`αup[15]`,`γup[1]`,`Z1[2]`,`αdown[23]` ))
iterates_long
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[2]","αdown[23]" ))
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[2]","αdown[23]" )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter) + geom_line()
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[2]","αdown[23]" )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter) + geom_line() + labs(y="")
df_acf <- iterates %>% group_by(chain) %>% reframe(acf=acf(`γup[1]`,plot=F)$acf, lag=acf(`γup[1]`,plot=F)$lag)
df_acf %>% ggplot(aes(x=lag, y=acf)) +
geom_bar(stat = "identity", position = "identity") + facet_wrap(~chain)
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[2]","αdown[23]" )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter) + geom_line() + labs(y="")
posterior_summary <- read_csv("figs/posterior_summary.csv")
str(posterior_summary)
posterior_summary %>% ggplot(aes(x=parameters, y=mean)) + geom_point()
posterior_summary %>% ggplot(aes(x=parameters, y=mean)) + geom_point() + coord_flip()
?geom_errorbar
posterior_summary
posterior_summary <- posterior_summary %>% mutate(lower=mean-2*std, upper=mean+2*std)
posterior_summary %>% ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) + coord_flip()
posterior_summary %>% ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + coord_flip()
posterior_summary
?contains
?str_detect
posterior_summary %>% dplyr::filter(str_detect("α"))
str(posterior_summary)
posterior_summary %>% dplyr::filter(parameters, str_detect("α"))
posterior_summary %>% dplyr::filter(str_detect(parameters, "α"))
posterior_summary %>% dplyr::filter(str_detect(parameters, "α")) %>%
ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + coord_flip()
library(tidyverse)
library(forecast)
library(ggpubr)
setwd("~/.julia/dev/LatentMarkovQuest/examples/olympic")
theme_set(theme_bw())
library(readr)
iterates_full <- read_csv("figs/iterates.csv", col_types = cols(chain = col_character()))
#View(iterates)
iterates <- iterates_full %>% select(1:70)
iterates_long <- pivot_longer(iterates, 3:70, names_to="parameter", values_to="value")
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[2]","αdown[23]" )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter) + geom_line() + labs(y="")
names(iterates)
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[2]","αdown[23]","γdown[1]",  "γdown[2],"  "γdown[3]"  )) %>%
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[2]","αdown[23]","γdown[1]",  "γdown[2]"  "γdown[3]"  )) %>%
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[2]","αdown[23]","γdown[1]",  "γdown[2]",  "γdown[3]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter) + geom_line() + labs(y="")
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[2]","αdown[23]","γdown[1]",  "γdown[2]",  "γdown[3]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free") + geom_line() + labs(y="")
0.55*7.75 + 0.35*8+0.1*7
library(readr)
iterates_full <- read_csv("figs/iterates.csv", col_types = cols(chain = col_character()))
#View(iterates)
iterates <- iterates_full %>% select(1:70)
iterates_long <- pivot_longer(iterates, 3:70, names_to="parameter", values_to="value")
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[2]","αdown[23]","γdown[1]",  "γdown[2]",  "γdown[3]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free") + geom_line() + labs(y="")
df_acf <- iterates %>% group_by(chain) %>% reframe(acf=acf(`γup[1]`,plot=F)$acf, lag=acf(`γup[1]`,plot=F)$lag)
df_acf %>% ggplot(aes(x=lag, y=acf)) +
geom_bar(stat = "identity", position = "identity") + facet_wrap(~chain)
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[2]","αdown[23]","γdown[1]",  "γdown[2]",  "γdown[3]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free") + geom_line() + labs(y="")
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[1]","Z1[2]","Z1[3]","αdown[23]","γdown[1]",  "γdown[2]",  "γdown[3]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free") + geom_line() + labs(y="")
library(bayesplot)
post = as.matrix(iterates[,1:10])
post
mcmc_areas(post)
rlang::last_trace()
rlang::last_trace(drop = FALSE)
?mcmc_trace
mcmc_trace(post)
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[1]","Z1[2]","Z1[3]","αdown[23]","γdown[1]",  "γdown[2]",  "γdown[3]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free") + geom_line() + labs(y="")
posterior_summary
posterior_summary %>% ggplot(aes(x=rhat,y=parameters) + geom_point()
)
posterior_summary %>% ggplot(aes(x=rhat,y=parameters)) + geom_point()
posterior_summary <- read_csv("figs/posterior_summary.csv")
posterior_summary %>% ggplot(aes(x=rhat,y=parameters)) + geom_point()
posterior_summary %>% dplyr::filter(rhat >1.6) %>%  ggplot(aes(x=rhat,y=parameters)) + geom_point()
library(readr)
iterates_full <- read_csv("figs/iterates.csv", col_types = cols(chain = col_character()))
#View(iterates)
iterates <- iterates_full %>% select(1:70)
iterates_long <- pivot_longer(iterates, 3:70, names_to="parameter", values_to="value")
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[1]","Z1[2]","Z1[3]","αdown[23]","γdown[1]",  "γdown[2]",  "γdown[3]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free") + geom_line() + labs(y="")
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "αup[1]","αdown[1]","αup[2]","αdown[2]","αup[3]","αdown[3]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free") + geom_line() + labs(y="")
iterates_long %>% dplyr::filter(parameter %in% c("αup[1]","αdown[1]","αup[2]","αdown[2]","αup[3]","αdown[3]","αup[23]","αdown[23]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free",ncol=2) + geom_line() + labs(y="")
iterates_long %>% dplyr::filter(parameter %in% c("αup[1]","αdown[1]","αup[2]","αdown[2]","αup[3]","αdown[3]","αup[23]","αdown[23]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free",nrow=2) + geom_line() + labs(y="")
iterates_long %>% dplyr::filter(parameter %in% c("Z1[1]","Z1[2]","Z1[3]","Z2[1]","Z2[2]","Z2[3]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free",nrow=2) + geom_line() + labs(y="")
library(readr)
iterates_full <- read_csv("figs/iterates.csv", col_types = cols(chain = col_character()))
#View(iterates)
iterates <- iterates_full %>% select(1:70)
iterates_long <- pivot_longer(iterates, 3:70, names_to="parameter", values_to="value")
pairs(iterates[:,10])
pairs(iterates[,1:10])
pairs(as.matrix(iterates[,1:10]))
iterates
pairs(as.matrix(iterates[,13:10]))
pairs(as.matrix(iterates[,3:10]))
?ggpairs
library(GGally)
ggpairs(iterates, mapping = aes(color = chain), columns = 3:10)
ggpairs(iterates, mapping = aes(color = chain), columns = 3:20)
corr(iterates[3:40])
library(tidyverse)
library(forecast)
library(ggpubr)
library(GGally)
setwd("~/.julia/dev/LatentMarkovQuest/examples/olympic")
theme_set(theme_bw())
library(readr)
iterates_full <- read_csv("figs/iterates.csv", col_types = cols(chain = col_character()))
#View(iterates)
iterates <- iterates_full %>% select(1:70)
names(iterates_full)
#View(iterates)
iterates <- iterates_full %>% select(1:31)
iterates_long <- pivot_longer(iterates, 3:70, names_to="parameter", values_to="value")
iterates_long <- pivot_longer(iterates, 3:31, names_to="parameter", values_to="value")
iterates_long %>% dplyr::filter(parameter %in% c("σα²", "σ²","αup[15]","γup[1]","Z1[1]","Z1[2]","Z1[3]","αdown[23]","γdown[1]",  "γdown[2]",  "γdown[3]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free") + geom_line() + labs(y="")
iterates_long %>% dplyr::filter(parameter %in% c("σ²","αup[15]","γup[1]","Z1[1]","Z1[2]","Z1[3]","γ12[1]",  "γ21[2]",  "32n[3]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free") + geom_line() + labs(y="")
iterates_long %>% dplyr::filter(parameter %in% c("Z1[1]","Z1[2]","Z1[3]","Z2[1]","Z2[2]","Z2[3]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free",nrow=2) + geom_line() + labs(y="")
iterates_long %>% dplyr::filter(parameter %in% c("σ²","γ12[1]", "γ12[2]","γ1231]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free") + geom_line() + labs(y="")
names(iterates)
iterates_long %>% dplyr::filter(parameter %in% c("σ²","γ12[1]", "γ12[2]", "γ32[3]"  ,"γ32[1]" ,"γ32[2]"   )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free") + geom_line() + labs(y="")
iterates_long %>% dplyr::filter(parameter %in% c("σ²","γ12[1]", "γ12[2]", "γ32[3]"  ,"γ32[1]" ,"γ32[2]"   )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free",ncol=1) + geom_line() + labs(y="")
posterior_summary <- read_csv("figs/posterior_summary.csv")
posterior_summary %>% dplyr::filter(rhat >1.6) %>%  ggplot(aes(x=rhat,y=parameters)) + geom_point()
posterior_summary <- posterior_summary %>% mutate(lower=mean-2*std, upper=mean+2*std)
posterior_summary <- posterior_summary %>% mutate(lower=mean-2*std, upper=mean+2*std)
posterior_summary %>% ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "α")) %>%
ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + coord_flip()
posterior_summary <- read_csv("figs/posterior_summary.csv")
posterior_summary %>% dplyr::filter(rhat >1.6) %>%  ggplot(aes(x=rhat,y=parameters)) + geom_point()
posterior_summary <- posterior_summary %>% mutate(lower=mean-2*std, upper=mean+2*std)
posterior_summary %>% ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "α")) %>%
ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + coord_flip()
posterior_summary <- read_csv("figs/posterior_summary.csv")
posterior_summary %>% dplyr::filter(rhat >1.6) %>%  ggplot(aes(x=rhat,y=parameters)) + geom_point()
posterior_summary <- posterior_summary %>% mutate(lower=mean-2*std, upper=mean+2*std)
posterior_summary %>% ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "α")) %>%
ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + coord_flip()
posterior_summary <- posterior_summary %>% mutate(lower=mean-2*std, upper=mean+2*std)
posterior_summary %>% ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "Z")) %>%
ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') +
labs(x="parameter", y="") + coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') +
labs(x="parameter", y="") + geom_hline(aes(x=0)) + coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') +
labs(x="parameter", y="") + geom_hline(aes(y=0)) + coord_flip()
?geom_hline
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0))
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) + coord_flip()
str(posterior_summary)
str(posterior_summary)
view(posterior_summary)
posterior_summary <- read_csv("figs/posterior_summary.csv") %>%
mutate(type=c("sigma", rep("up1",4), rep("up2",4), rep("down2",4), rep("down3",4),
rep("Z1",3), rep("Z2",3), rep("Z3",3), rep("Z4",3)    ))
type=c("sigma", rep("up1",4), rep("up2",4), rep("down2",4), rep("down3",4),
rep("Z1",3), rep("Z2",3), rep("Z3",3), rep("Z4",3)
type=c("sigma", rep("up1",4), rep("up2",4), rep("down2",4), rep("down3",4),
type=c("sigma", rep("up1",4), rep("up2",4), rep("down2",4), rep("down3",4),
rep("Z1",3), rep("Z2",3), rep("Z3",3), rep("Z4",3)    )
posterior_summary <- read_csv("figs/posterior_summary.csv") %>%
mutate(type=c("sigma", rep("up1",4), rep("up2",4), rep("down2",4), rep("down3",4),
rep("Z1",3), rep("Z2",3), rep("Z3",3), rep("Z4",3)    ))
view(posterior_summary)
posterior_summary %>% dplyr::filter(rhat >1.6) %>%  ggplot(aes(x=rhat,y=parameters)) + geom_point()
posterior_summary <- read_csv("figs/posterior_summary.csv") %>%
mutate(type=c("sigma", rep("up1",4), rep("up2",4), rep("down2",4), rep("down3",4),
rep("Z1",3), rep("Z2",3), rep("Z3",3), rep("Z4",3)    ))
posterior_summary <- posterior_summary %>% mutate(lower=mean-2*std, upper=mean+2*std)
posterior_summary %>% ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + coord_flip()
posterior_summary %>% ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + facet_wrap(~type) +  coord_flip()
posterior_summary %>% ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') + facet_wrap(~type,scales="free") +  coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) + coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
ggplot(aes(x=parameters, y=mean, colour=type)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) + coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
ggplot(aes(x=parameters, y=mean, colour=type)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) + coord_flip()
posterior_summary %>% ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') +  coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
ggplot(aes(x=parameters, y=mean, colour=type)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) +  facet_wrap(~type,scales="free")+ coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
ggplot(aes(x=parameters, y=mean, colour=type)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) +  facet_wrap(~type,scales="free_y")+ coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) +  facet_wrap(~type,scales="free_y")+ coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>% view()
posterior_summary %>% ggplot(aes(x=parameters, y=mean)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper),colour='red') +  coord_flip()
posterior_summary %>% ggplot(aes(x=parameters, y=mean, colour=type)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +  coord_flip()
covariate = c("intercept", "sport","strength","competition")
covariate = c("intercept", "sport","strength","competition")
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
mutate(covariate=rep(covariates,4)) %>%
ggplot(aes(x=parameters, y=mean, colour=covariate)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) +  facet_wrap(~type,scales="free_y")+ coord_flip()
covariates = c("intercept", "sport","strength","competition")
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
mutate(covariate=rep(covariates,4)) %>%
ggplot(aes(x=parameters, y=mean, colour=covariate)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) +  facet_wrap(~type,scales="free_y")+ coord_flip()
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
mutate(covariate=rep(covariates,4)) %>%
ggplot(aes(x=parameters, y=mean, colour=covariate)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) +  facet_wrap(~type,scales="free_y")+ coord_flip() +
theme(legend.position = "bottom")
posterior_summary <- read_csv("figs/posterior_summary.csv") %>%
mutate(type=c("sigma", rep("from 1 to 2",4), rep("from 2 to 3",4), rep("from 2 to 1",4), rep("from 3 to 2",4),
rep("Z1",3), rep("Z2",3), rep("Z3",3), rep("Z4",3)    ))
posterior_summary <- posterior_summary %>% mutate(lower=mean-2*std, upper=mean+2*std)
posterior_summary %>% ggplot(aes(x=parameters, y=mean, colour=type)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +  coord_flip()
covariates = c("intercept", "sport","strength","competition")
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
mutate(covariate=rep(covariates,4)) %>%
ggplot(aes(x=parameters, y=mean, colour=covariate)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) +  facet_wrap(~type,scales="free_y")+ coord_flip() +
theme(legend.position = "bottom")
?scale
olymp %>% summarise(m=mean(Sport, na.rm=TRUE), std=sd(Sport, na.rm=TRUE))
setwd("~/.julia/dev/LatentMarkovQuest/examples/olympic")
library(tidyverse)
library(readr)
library(fastDummies)
olymp <- read_csv("olympic_athletes.csv",
col_types = cols(ID = col_character())) %>%
mutate(Competition=as.numeric(Competition))
olymp %>% summarise(m=mean(Sport, na.rm=TRUE), std=sd(Sport, na.rm=TRUE))
olymp %>% summarise(m=mean(Strength, na.rm=TRUE), std=sd(Strength, na.rm=TRUE))
olymp %>% summarise(m=mean(Competition, na.rm=TRUE), std=sd(Competition, na.rm=TRUE))
Covariates <- read_csv("Covariates.csv")
Covariates
olymp %>% summarise(m=mean(Sport, na.rm=TRUE), std=sd(Sport, na.rm=TRUE))
?tibble
t(as.matrix(Covariates))
tibble(t(as.matrix(Covariates)))
t(as.matrix(Covariates))
olymp %>% summarise(m=mean(Sport, na.rm=TRUE), std=sd(Sport, na.rm=TRUE))
mm[,2] <- (mm[,2]-10.2)/5.12
mm <- t(as.matrix(Covariates))
mm[,2] <- (mm[,2]-10.2)/5.12
mm
olymp %>% summarise(m=mean(Strength, na.rm=TRUE), std=sd(Strength, na.rm=TRUE))
olymp %>% summarise(m=mean(Competition, na.rm=TRUE), std=sd(Competition, na.rm=TRUE))
Covariates <- read_csv("Covariates.csv")
mm[,2] <- (mm[,2]-10.2)/5.12
olymp %>% summarise(m=mean(Sport, na.rm=TRUE), std=sd(Sport, na.rm=TRUE))
olymp %>% summarise(m=mean(Competition, na.rm=TRUE), std=sd(Competition, na.rm=TRUE))
olymp %>% summarise(m=mean(Sport, na.rm=TRUE), std=sd(Sport, na.rm=TRUE))
olymp %>% summarise(m=mean(Strength, na.rm=TRUE), std=sd(Strength, na.rm=TRUE))
olymp %>% summarise(m=mean(Competition, na.rm=TRUE), std=sd(Competition, na.rm=TRUE))
mm <- t(as.matrix(Covariates))
mm[,2] <- (mm[,2]-10.2)/5.12
mm[,3] <- (mm[,3]-3.45)/2.12
mm[,4] <- (mm[,4]-1.89)/1.91
mm
Covariates_standardised <- tible(mm)
Covariates_standardised <- tibble(mm)
Covariates_standardised
write.csv(Covariates_standardised, "Covariates_standardised.csv", row.names=FALSE)
library(tidyverse)
library(forecast)
library(ggpubr)
library(GGally)
setwd("~/.julia/dev/LatentMarkovQuest/examples/olympic")
theme_set(theme_bw())
library(readr)
iterates_full <- read_csv("figs/iterates.csv", col_types = cols(chain = col_character()))
#View(iterates)
iterates <- iterates_full %>% select(1:31)
#ggpairs(iterates, mapping = aes(color = chain), columns = 3:20)
iterates_long <- pivot_longer(iterates, 3:31, names_to="parameter", values_to="value")
iterates_long %>% dplyr::filter(parameter %in% c("σ²","γ12[1]", "γ12[2]", "γ32[3]"  ,"γ32[1]" ,"γ32[2]"   )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free",ncol=1) + geom_line() + labs(y="")
iterates_long %>% dplyr::filter(parameter %in% c("σ²","γ12[1]", "γ12[2]", "γ32[3]"  ,"γ32[1]" ,"γ32[2]"   )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free",ncol=2) + geom_line() + labs(y="")
ggsave("~/figs/traceplots2.pdf", width=6, height=2.5)
ggsave("figs/traceplots2.pdf", width=6, height=2.5)
?warnings
warnings()
ggsave("figs/traceplots2.pdf", width=6, height=8)
iterates_long %>% dplyr::filter(parameter %in% c("σ²","γ12[1]", "γ12[2]", "γ32[3]"  ,"γ32[1]" ,"γ32[2]"   )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free",ncol=2) + geom_line() + labs(y="")
ggsave("figs/traceplots1.pdf", width=6, height=8)
iterates_long %>% dplyr::filter(parameter %in% c("Z1[1]","Z1[2]","Z1[3]","Z2[1]","Z2[2]","Z2[3]"  )) %>%
ggplot(aes(x=iteration, y=value, colour=chain)) + facet_wrap(~parameter,scales="free",nrow=2) + geom_line() + labs(y="")
ggsave("figs/traceplots1.pdf", width=6, height=8)
posterior_summary <- read_csv("figs/posterior_summary.csv") %>%
mutate(type=c("sigma", rep("from 1 to 2",4), rep("from 2 to 3",4), rep("from 2 to 1",4), rep("from 3 to 2",4),
rep("Z1",3), rep("Z2",3), rep("Z3",3), rep("Z4",3)    ))
posterior_summary <- posterior_summary %>% mutate(lower=mean-2*std, upper=mean+2*std)
posterior_summary %>% ggplot(aes(x=parameters, y=mean, colour=type)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +  coord_flip()
ggsave("figs/estimates.pdf")
tibble("\u03b1"=rnorm(10))
tibble("\u03b1"=rnorm(10)) %>% ggplot(aes(x="\u03b1")) + geom_histogram()
tibble("\u03b1"=rnorm(10)) %>% ggplot(aes(x="\u03b1"))
?geom_histogram
tibble("\u03b1"=rnorm(10)) %>% ggplot(aes("\u03b1"))
tibble("\u03b1"=rnorm(10)) %>% ggplot(aes("\u03b1")) + geom_histogram()
tibble("\u03b1"=rnorm(10), y =rnorm(10)) %>% ggplot(aes(x="\u03b1",y=y)) + geom_point()
posterior_summary <- posterior_summary %>% mutate(lower=mean-2*std, upper=mean+2*std)
posterior_summary %>% ggplot(aes(x=parameters, y=mean, colour=type)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +  coord_flip()
posterior_summary <- read_csv("figs/posterior_summary.csv") %>%
mutate(type=c("sigma", rep("from 1 to 2",4), rep("from 2 to 3",4), rep("from 2 to 1",4), rep("from 3 to 2",4),
rep("Z1",3), rep("Z2",3), rep("Z3",3), rep("Z4",3)    ))
posterior_summary <- posterior_summary %>% mutate(lower=mean-2*std, upper=mean+2*std)
posterior_summary %>% ggplot(aes(x=parameters, y=mean, colour=type)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +  coord_flip()
pdf("figs/estimates.pdf")
posterior_summary %>% ggplot(aes(x=parameters, y=mean, colour=type)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +  coord_flip()
dev.off()
warnings()
covariates = c("intercept", "sport","strength","competition")
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
mutate(covariate=rep(covariates,4)) %>%
ggplot(aes(x=parameters, y=mean, colour=covariate)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) +  facet_wrap(~type,scales="free_y")+ coord_flip() +
theme(legend.position = "bottom")
covariates = c("intercept", "sport","strength","competition")
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
mutate(covariate=rep(covariates,4)) %>%
ggplot(aes(x=parameters, y=mean, colour=covariate)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) +  facet_wrap(~type,scales="free_y")+ coord_flip() +
theme(legend.position = "bottom")
ggsave("figs/gamma_estimates.pdf")
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
mutate(covariate=rep(covariates,4)) %>%
ggplot(aes(x=parameters, y=mean, colour=covariate)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) +
facet_wrap(~type,scales="free_y")+
theme( axis.text.y = element_blank())+
coord_flip() +
theme(legend.position = "bottom")
covariates = c("intercept", "sport","strength","competition")
posterior_summary %>% dplyr::filter(str_detect(parameters, "γ")) %>%
mutate(covariate=rep(covariates,4)) %>%
ggplot(aes(x=parameters, y=mean, colour=covariate)) + geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper)) +
labs(x="parameter", y="") + geom_hline(aes(yintercept=0)) +
facet_wrap(~type,scales="free_y")+
theme( axis.text.y = element_blank())+
coord_flip() +
theme(legend.position = "bottom")
ggsave("figs/gamma_estimates.pdf")
